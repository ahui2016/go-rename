# gof

gof: a file/folder processor written in Go

可自由添加扩展的文件/文件夹处理器。

暂时只有一个扩展作为示例: swap, 用于对调两个文件的文件名。

纯 Go 语言实现，扩展也是使用 Go 来写，通过添加扩展可对文件/文件夹进行随心所欲的操作，比如：

- 对调两个文件的文件名
- 把指定文件备份到指定文件夹，并自动改名
- 把指定文件移动到指定文件夹，并自动删除超过 n 天的旧文件
- 按你喜欢的方式单向/双向同步两个文件夹（具体就看扩展代码怎样写了）
- ……等等

有什么特殊的需求，都可以自己写 Go 代码来实现。

简而言之，就是本程序搭好了脚手架，处理好了一些通用的逻辑，让你可以专注于实现具体的文件操作代码。

## 安装方法

配置好 Go 语言环境后，执行以下命令：
```
$ go install github.com/ahui2016/gof@latest
```

## 使用方法

本仓库的源代码里提供了一个 examples 文件夹，下载到本地后在 examples 的各个子文件夹里执行以下命令可试验是否安装成功：
```
$ gof -f gof.yaml
```

如果在当前文件夹里有一个 gof.yaml 文件, 则可以省略 `-f` 参数。
```
$ gof
```

可以在 yaml 文件里设定需要处理的文件，也可以用命令行指定，例如：
```
$ gof -f gof.yaml file1.txt file2.txt
```

**注意**: 通过命令行指定文件时，如果 YAML 文件里有多个任务，那么每个任务都会统一采用命令行指定的文件。命令行的优先级比 YAML 文件更高。

如果使用 yaml 文件，可以在文件里设定处理方式 (recipe) 并且为每个任务设定不同的 options (上面的示例都使用了 yaml 文件)。

也可以不使用 yaml 文件，通过命令行来指定处理方式 (recipe):
```
$ gof -r swap file1.txt file2.txt
```

使用 yaml 文件可依次执行多个任务，可以设定不同的 options, 而使用参数 `-r` 指定 recipe 则每次只能执行一个任务，并且只能使用默认的 options。

## 关于 go install 和 GOBIN

如果设置了 GOBIN, 那么程序会被安装在 GOBIN 里，需要手动添加目录到环境变量中。
GOBIN 的具体位置可以用以下命令查看：
```
$ go env GOBIN
```

如果未设置 GOBIN, 请查看 go install 的帮助信息：
```
$ go help install
```

## 添加扩展

本程序采用了很容易添加扩展的设计，添加一个扩展的步骤如下：

1. fork 本仓库以方便修改
2. 在 recipes 文件夹里新建一个 `.go` 文件，第一行内容为 `package recipes`, 在该文件中定义一个 struct 并使其实现 Recipe 接口（参考 recipes 文件夹中已有的文件）
3. 在 main.go 里注册需要用到的 recipe
4. 不是必须，但建议在 examples 文件夹里添加用于测试的文件

完成。

最后可以 go install 你自己定制版本的 gof

## 温馨提示

由于本程序涉及文件操作，实际使用前请先找一些无用文件来试验，确认没问题后再实际使用。

如果使用别人写的扩展，建议在试验前先检查源码。Go 语言很直白，这个检查通常是轻松的。
